# Prevent duplicates in PATH automatically
typeset -U path

# XDG Base Directory specification
# https://specifications.freedesktop.org/basedir-spec/latest/
export XDG_DATA_HOME="${XDG_DATA_HOME:-$HOME/.local/share}"
export XDG_CONFIG_HOME="${XDG_CONFIG_HOME:-$HOME/.config}"
export XDG_STATE_HOME="${XDG_STATE_HOME:-$HOME/.local/state}"
export XDG_CACHE_HOME="${XDG_CACHE_HOME:-$HOME/.cache}"

# XDG system directories
export XDG_DATA_DIRS="${XDG_DATA_DIRS:-/usr/local/share:/usr/share}"
export XDG_CONFIG_DIRS="${XDG_CONFIG_DIRS:-/etc/xdg}"

# Add bun global bin directory to PATH
[[ -d "$HOME/.cache/.bun/bin" ]] && path=("$HOME/.cache/.bun/bin" $path)

# Add ~/.local/bin to front of PATH
[[ -d "$HOME/.local/bin" ]] && path=("$HOME/.local/bin" $path)

# Source cargo environment for Rust toolchain
if [[ -f "$HOME/.cargo/env" ]]; then
  source "$HOME/.cargo/env"
fi

# Editor configuration
export EDITOR="nvim"

# Pager configuration
export PAGER="less"
export LESS="-FR"

# NPM security hardening - disable postinstall scripts for global CLI tools
export NPM_CONFIG_IGNORE_SCRIPTS=1

# 1Password SSH Agent (for tools that don't read ~/.ssh/config like jj)
# This ensures SSH_AUTH_SOCK points to 1Password's agent on macOS
if [[ "$OSTYPE" == darwin* ]]; then
  export SSH_AUTH_SOCK="$HOME/Library/Group Containers/2BUA8C4S2C.com.1password/t/agent.sock"
fi

# Use homebrew openssl (for ruby)
export PKG_CONFIG_PATH="/opt/homebrew/opt/openssl@3/lib/pkgconfig:$PKG_CONFIG_PATH"
export LDFLAGS="-L/opt/homebrew/opt/openssl@3/lib"
export CPPFLAGS="-I/opt/homebrew/opt/openssl@3/include"
