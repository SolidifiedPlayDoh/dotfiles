#!/usr/bin/env zsh
# LLM Agent Mode Configuration
# Provides simple, parseable output for LLM agents like Claude Code
# Disables interactive features, colors, and pagers
# This file is sourced when an LLM agent is detected via envsense

# Disable Oh My Zsh theme and use simple prompt
unset ZSH_THEME
PS1='%~ %# '

# Disable colors globally
export NO_COLOR=1

# Set simple pagers
export PAGER=cat
export GIT_PAGER=cat
export MANPAGER=cat
export LESS=-FX  # Exit if one screen, no init

# Override bat to use plain mode
export BAT_STYLE=plain
export BAT_PAGER=

# Git configuration overrides
export GIT_CONFIG_GLOBAL="$XDG_CONFIG_HOME/git/config-llm"

# Disable interactive completions and suggestions
unset ZSH_AUTOSUGGEST_MANUAL_REBIND
export ZSH_AUTOSUGGEST_USE_ASYNC=0

# Remove all fancy aliases that override basic tools
# Restore basic commands for LLM agents
unalias cat 2>/dev/null
unalias ls 2>/dev/null
unalias grep 2>/dev/null
unalias vi 2>/dev/null
unalias vim 2>/dev/null
unalias top 2>/dev/null
unalias df 2>/dev/null
unalias du 2>/dev/null
unalias git 2>/dev/null
unalias make 2>/dev/null

# Simple grep without colors
alias grep='grep -Hn'

# Disable zsh features that interfere with LLM parsing
setopt NO_BEEP
setopt NO_AUTO_CD
setopt NO_CORRECT
setopt NO_CORRECT_ALL
unsetopt PROMPT_CR
unsetopt PROMPT_SP

# Disable syntax highlighting and autosuggestions for LLM mode
# These are loaded after this file in .zshrc, so we set a flag
export SKIP_ZSH_SYNTAX_HIGHLIGHTING=1
export SKIP_ZSH_AUTOSUGGESTIONS=1

# mise - version manager for languages and tools
{{- if lookPath "mise" }}
# mise manages its own hooks, run directly (don't cache)
eval "$(mise activate zsh)"
{{- end }}

# vi: ft=zsh
